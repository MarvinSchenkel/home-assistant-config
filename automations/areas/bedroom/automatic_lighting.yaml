---
# I use circadian lighting for all the lights in my house.
# Whenever I want to manually override the brightness by using
# my IKEA remote, this automation sets a boolean that will make sure the 
# lights do not change back to the circadian value.
alias: areas_bedroom_automatic_lighting
description: >
  Turn off automatic lightning when manual controls are detected

use_blueprint:
  path: wormie_dk/zha-ikea-five-button-remote.yaml
  input:
    remote: d1b641827c2d934e455536d561d12866
    button_on_off:
      - service: input_boolean.turn_off
        data:
          entity_id: input_boolean.bedroom_automatic_lighting
      - wait_for_trigger:
          platform: state
          entity_id: binary_sensor.presence_bedroom
          from: "on"
          to: "off"
      - delay:
          seconds: 300
      - service: input_boolean.turn_on
        data:
          entity_id: input_boolean.bedroom_automatic_lighting
      - service: light.turn_off
        entity_id:
          - light.zha_group_bedroom
    button_brightness_up_short:
      - service: input_boolean.turn_off
        data:
          entity_id: input_boolean.bedroom_automatic_lighting
      - wait_for_trigger:
          platform: state
          entity_id: binary_sensor.presence_bedroom
          from: "on"
          to: "off"
      - delay:
          seconds: 300
      - service: input_boolean.turn_on
        data:
          entity_id: input_boolean.bedroom_automatic_lighting
      - service: light.turn_off
        entity_id:
          - light.zha_group_bedroom
    button_brightness_down_short:
      - service: input_boolean.turn_off
        data:
          entity_id: input_boolean.bedroom_automatic_lighting
      - wait_for_trigger:
          platform: state
          entity_id: binary_sensor.presence_bedroom
          from: "on"
          to: "off"
      - delay:
          seconds: 300
      - service: input_boolean.turn_on
        data:
          entity_id: input_boolean.bedroom_automatic_lighting
      - service: light.turn_off
        entity_id:
          - light.zha_group_bedroom